/**

*/
import { TokenObject } from '../auth/authenticate';
import { BranchData, EventBus } from '@tinacms/toolkit';
import { DocumentNode, GraphQLSchema } from 'graphql';
import gql from 'graphql-tag';
import { TinaSchema, TinaCloudSchema } from '@tinacms/schema-tools';
export declare type OnLoginFunc = (args: {
    token: TokenObject;
}) => Promise<void>;
export declare type TinaIOConfig = {
    assetsApiUrlOverride?: string;
    frontendUrlOverride?: string;
    identityApiUrlOverride?: string;
    contentApiUrlOverride?: string;
};
interface ServerOptions {
    schema?: TinaCloudSchema<false>;
    clientId: string;
    branch: string;
    customContentApiUrl?: string;
    getTokenFn?: () => Promise<TokenObject>;
    tinaioConfig?: TinaIOConfig;
    tokenStorage?: 'MEMORY' | 'LOCAL_STORAGE' | 'CUSTOM';
}
export declare class Client {
    onLogin?: OnLoginFunc;
    onLogout?: () => Promise<void>;
    frontendUrl: string;
    contentApiUrl: string;
    identityApiUrl: string;
    assetsApiUrl: string;
    gqlSchema: GraphQLSchema;
    schema?: TinaSchema;
    clientId: string;
    contentApiBase: string;
    query: string;
    setToken: (_token: TokenObject) => void;
    private getToken;
    private token;
    private branch;
    private options;
    events: EventBus;
    constructor({ tokenStorage, ...options }: ServerOptions);
    get isLocalMode(): boolean;
    setBranch(branchName: string): void;
    addPendingContent: (props: any) => Promise<unknown>;
    getSchema: () => Promise<GraphQLSchema>;
    /**
     *
     * Returns a version of the query with fragments inlined. Eg.
     * ```graphql
     * {
     *   getPostDocument(relativePath: "") {
     *     data {
     *       ...PostFragment
     *     }
     *   }
     * }
     *
     * fragment PostFragment on Post {
     *   title
     * }
     * ```
     * Turns into
     * ```graphql
     * {
     *   getPostDocument(relativePath: "") {
     *     data {
     *       title
     *     }
     *   }
     * }
     */
    getOptimizedQuery: (documentNode: DocumentNode) => Promise<DocumentNode>;
    requestWithForm<ReturnType>(query: (gqlTag: typeof gql) => DocumentNode, { variables, useUnstableFormify, }: {
        variables: any;
        useUnstableFormify?: boolean;
    }): Promise<ReturnType>;
    request<ReturnType>(query: ((gqlTag: typeof gql) => DocumentNode) | string, { variables }: {
        variables: object;
    }): Promise<ReturnType>;
    syncTinaMedia(): Promise<{
        assetsSyncing: string[];
    }>;
    checkSyncStatus({ assetsSyncing, }: {
        assetsSyncing: string[];
    }): Promise<{
        assetsSyncing: string[];
    }>;
    fetchEvents(limit?: number, cursor?: string): Promise<{
        events: {
            message: string;
            timestamp: number;
            id: string;
            isError: boolean;
            isGlobal: boolean;
        }[];
        cursor?: string;
    }>;
    parseJwt(token: any): any;
    getRefreshedToken(tokens: string): Promise<TokenObject>;
    isAuthorized(): Promise<boolean>;
    isAuthenticated(): Promise<boolean>;
    logout(): Promise<void>;
    authenticate(): Promise<TokenObject>;
    /**
     * Wraps the normal fetch function with same API but adds the authorization header token.
     *
     * @example
     * const test = await tinaCloudClient.fetchWithToken(`/mycustomAPI/thing/one`) // the token will be passed in the authorization header
     *
     * @param input fetch function input
     * @param init fetch function init
     */
    fetchWithToken(input: RequestInfo, init?: RequestInit): Promise<Response>;
    getUser(): Promise<any>;
    getBillingState(): Promise<{
        clientId: string;
        delinquencyDate: number;
        billingState: 'current' | 'late' | 'delinquent';
    }>;
    listBranches(): Promise<any>;
    createBranch({ baseBranch, branchName }: BranchData): Promise<string>;
}
export declare const DEFAULT_LOCAL_TINA_GQL_SERVER_URL = "http://localhost:4001/graphql";
export declare class LocalClient extends Client {
    constructor(props?: {
        customContentApiUrl?: string;
        schema?: TinaCloudSchema<false>;
    } & Omit<ServerOptions, 'clientId' | 'branch'>);
    get isLocalMode(): boolean;
    logout(): Promise<void>;
    authenticate(): Promise<{
        access_token: string;
        id_token: string;
        refresh_token: string;
    }>;
    getUser(): Promise<boolean>;
}
export {};
